<!doctype html>
<!--  https://www.maps.ie/coordinates.html -->
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>GAT A.R.</title>
        <!--<script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>-->
        <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
        <!--<script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>  per animazione-->
        <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
        <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    </head>
    <script>
            function returnDistance(location, text){// funzione             
                let distance = location.getAttribute('distanceMsg');
                if (!distance) distance = "---"; // se ancora non l'ha calcolata
                return text + distance;
            }
            window.addEventListener('load', () => {
                const location_temenide = document.getElementById('temenide');
                const location_gat = document.getElementById('gat');
                const location_vito = document.getElementById('vito');
                const location_antonietta = document.getElementById('antonietta');
                const text_temenide = document.getElementById('text-temenide');
                const text_officina = document.getElementById('text-officina');
                const text_gat = document.getElementById('text-gat');
                const text_vito = document.getElementById('text-vito');
                const text_antonietta = document.getElementById('text-antonietta');
                const magnemite = document.getElementById('magnemite');
                const head_savio = document.getElementById('head-savio');
                const off_line = document.getElementById('text-camera');             
                
                let blink = true;

                let blinkig = setInterval(() => {
                    blink ? off_line.setAttribute("opacity", 0): off_line.setAttribute("opacity", 1);
                    blink=!blink;                        
                }, 1000);

                let check = setInterval(() => {
                    text_temenide.setAttribute("value", returnDistance(location_temenide, "Via Temenide "));
                    text_gat.setAttribute("value", returnDistance(location_gat, "GAT "));
                    text_vito.setAttribute("value", returnDistance(location_vito, "Casa nonno Vito "));
                    text_antonietta.setAttribute("value", returnDistance(location_antonietta, "Casa nonna Antonietta "));
                    text_officina.setAttribute("value", returnDistance(magnemite, "Officina "));                    
                }, 100);
            });
    </script>   
    <body style="margin: 0; overflow: hidden;">
        <!-- con vr-mode-ui="enabled: false" abilita la funzione VR sul display -->
        <a-scene 
            vr-mode-ui="enabled: false" 
            embedded
            loading-screen="enabled: false;"
            arjs="sourceType: webcam; debugUIEnabled: false;">
                <a-image
                    src="/assets/location.png"
                    look-at="[gps-camera]"
                    scale="10 10 10"
                    gps-entity-place="latitude: 40.462654; longitude: 17.250845;"
                    position="0 0 0"
                    id="temenide"
                ></a-image>
                <a-text
                    value="Via temenide"
                    look-at="[gps-camera]"
                    scale="10 10 10"
                    gps-entity-place="latitude: 40.462654; longitude: 17.250845;"
                    position="0 0 0"
                    id="text-temenide"
                ></a-text>
                <!-- gat -->
                <a-image
                    src="/pubblic/assets/location.png"
                    look-at="[gps-camera]"
                    scale="1000 1000 1000"
                    gps-entity-place="latitude: 40.4233336; longitude: 17.2858356;"
                    id ="gat"
                ></a-image>
                <a-text
                    value="GAT"
                    look-at="[gps-camera]"
                    scale="1000 1000 1000"
                    gps-entity-place="latitude: 40.4233336; longitude: 17.2858356;"
                    id="text-gat"
                ></a-text>
                <a-entity gltf-model="/pubblic/assets/savio/test_2.gltf"                     
                    position="0 0 0"
                    rotation="0 0 0" 
                    scale=".1 .10 .10" 
                    gps-entity-place="latitude: 40.576860; longitude: 17.116746;"
                    id="head-savio"
                    color="red"
                    animation="property: rotation; to: 0 360 0; loop: true; dur: 20000; easing: linear;"
                ></a-entity>
                <a-entity gltf-model="/pubblic/assets/magnemite/scene.gltf" 
                    position="0 0 0"
                    rotation="0 0 0" 
                    scale=".2 .20 .20" 
                    gps-entity-place="latitude: 40.577367; longitude: 17.116729;"
                    id="magnemite"
                    color="red"
                    animation="property: rotation; to: 0 360 0; loop: true; dur: 20000; easing: linear;"
                ></a-entity>
                <a-text
                    value="Officina"
                    look-at="[gps-camera]"
                    scale="10 10 10"
                    gps-entity-place="latitude: 40.577367; longitude: 17.116729;"
                    id="text-officina"
                ></a-text>
                <a-image
                    src="/pubblic/assets/location.png"
                    look-at="[gps-camera]"
                    scale="10 10 10"
                    gps-entity-place="latitude: 40.4663771; longitude: 17.2471326;"
                    id="vito"
                ></a-image>
                <a-text
                    value="Casa nonno Vito"
                    look-at="[gps-camera]"
                    scale="10 10 10"
                    gps-entity-place="latitude: 40.4663771; longitude: 17.2471326;"
                    id="text-vito"
                ></a-text>
                <a-image
                    src="/pubblic/assets/location.png"
                    look-at="[gps-camera]"
                    scale="10 10 10"
                    gps-entity-place="latitude: 40.46705732564022; longitude: 17.2545455;"
                    id="antonietta"
                ></a-image>
                <a-text
                    value="Casa nonna Antonietta"
                    look-at="[gps-camera]"
                    scale="10 10 10"
                    gps-entity-place="latitude: 40.46705732564022; longitude: 17.2545455;"
                    id="text-antonietta"
                ></a-text>              
            <a-camera gps-camera="alert: true;" rotation-reader >  
                <a-text
                    position="-0.2 -0.3 -1"
                    value="off-line!"
                    
                    opacity=0
                    width="1"
                    color="red"
                    id="text-camera"
                ></a-text>
            </a-camera>
        </a-scene>
    </body>
</html>
